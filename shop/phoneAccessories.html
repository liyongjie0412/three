<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
	<script type="text/javascript" src="./path.js"></script>
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Document</title>
	<style type="text/css">
		*{margin: 0; padding: 0;}
		a{
			color: black;
			text-decoration: none;
			-webkit-tap-highlight-color: white;
		}
		ul li {
			list-style: none;
		}
		body{
			background: #f5f5f5;
		}
		html{
			font-size: 16px;
		}
		.header{
			position: fixed;
			left: 0;
			width: 20%;
			min-height: 100vh;
			background: #FFFFFF;
		}
		.header ul li{
			line-height: 50px;
			width: 100%;
			text-align: center;
			margin: 0 1%;
		}
		.header ul li a{
			color: #3D3D37;
			font-family: "微软雅黑";
			font-size: .9rem;
		}
		.header ul li a:hover{
			color: #F59626;
		}
		.header img{
			vertical-align: 2px;
			width: 50%;
		}
		
			footer{
				height: 40px;
				width: 100%;
				display: flex;
				justify-content: space-between;
				position: fixed;
				bottom: 0px;
				border-top: 1px solid #ccc;
				padding: 10px 0;
				box-shadow: 0px -2px 20px #ccc;
				background: white;
			}
			footer a{
				display: block;
				width: 25%;
			}
			footer a img{
				width: 30%;
				margin-left: 35%;
				margin-bottom: -5px;
			}
			footer a p{
				color: grey;
				text-align: center;
				font-size: 14px;
			}
			footer a:nth-child(2) p{
				color: red;
			}
			.contain{
				margin-left: 20%;
				width: 80%;
				background: #f5f5f5;
				display: flex;
				box-sizing: border-box;
				padding: 0px 2% 0;
				justify-content: space-between;
			}
			.contain>div{
				width: 50%;
				padding: 0px 0 0;
				box-sizing: border-box;
			}
			.contain>div div{
				margin-top: 4px;
				background: white;
				border-radius: 6px;
				box-sizing: border-box;
				padding: 10px 5px 0;
				font-size: 0.8rem;
			}
			.contain>div:nth-child(1){
				margin-right: 2px;
			}
			.contain>div:nth-child(2){
				margin-left: 2px;
			}
			.black{
				color: black;
				font-size: 0.9rem;
			}
			.grey{
				color: grey;
			}
			.orange{
				color: orange;	
			}	
			.show {
				margin-left: 20%;
				width: 80%;
				padding: 8px 0 0;
			}
			.show_text{
				width: 100%;
				text-align: center;
				line-height: 2rem;
				height: 2rem;
				font-size: 1rem;
				color: grey;
				margin-bottom: 8px;
			}
			.show_text span{
				margin: 0 20px;
			}
			.show_img{
				width: 96%;
				margin-left: 2%;
				background: white;
				margin-bottom: 8px;
			}
			.show_img img{
				width: 100%;
			}
			.show_img_lunbo{
				width: 100%;
			}
			.show_img_lunbo img{
				width: 100%;
			}
			.contain_footer{
				padding: 0px 2% 0;
			}
			.contain_footer>div{
				padding:0;
			}
			.contain_footer>div>a div{
				margin-bottom: 8px;
				padding-bottom: 5px;
			}
			.contain_footer img{
				width: 80%;
				margin-left: 10%;
				height: 25vw;
			}
			.contain_footer p{
				width: 100%;
				text-overflow:ellipsis; 
				white-space:nowrap;
				overflow:hidden;
			}
			.contain_footer .right img{
				width: 60%;
				margin-left: 20%;
				height: 25vw;
			}
			.contain_footer .orange img{
				width: 10%;
				margin-left: 0;
				float: right;
				margin-right: 15%;
				height: auto;
			}
			.img_show{
				padding: 1rem 0 ;
				margin: 0;
				width: 100%;
				background: white;
				position: relative;
				margin-bottom: 0.25rem;
			}
			.img_show img{
				position: absolute;
				right: 5%;
				bottom: 5px;
			}
			.img_show h3{
				font-size: 1.5rem;
				font-weight: normal;
				text-align: center;
				margin-bottom: 0.5rem;
			}
			.img_show p{
				margin-left: 5%;
				width: 50%;
				text-align: center;
				font-size: 0.9rem;
			}
	</style>
</head>
<body>
	<header class="header">
		<ul>
		
		</ul>
	</header>
	<div class="contain">
	
		</div>
		<div id="hot_new">
		<div class="show">
			<div class="show_text">→<span>新品上市</span>←</div>
			<div class="img_show img_show_new">
		  
			</div>
		</div>
		<div class="contain contain_footer" id="goods_new">
		  <div class='left'>
		  </div>
		  <div class='right'>
		  </div>
		</div>
		<div class="show">
			<div class="show_text">→<span>热销产品</span>←</div>
			<div class="img_show img_show_hot">
			</div>
		</div>
		<div class="contain contain_footer" style="margin-bottom: 80px;" id="goods_hot">
			  <div class='left'>
		  </div>
		  <div class='right'>
		  </div>
		</div>
	  </div>
	  <div class="show">
			<div class="show_text">→<span>全部产品</span>←</div>
			<div class="img_show img_show_all">
			</div>
		</div>
		<div class="contain contain_footer" style="margin-bottom: 70px;" id="goods_category_all">
			<div class='left'>
		  </div>
		  <div class='right'>
		  </div>
		</div>
		<footer>
			<a href="index.html">
				<div>
					<img src="images/icon_home.png"/>
					<p>首页</p>
				</div>			
			</a>
			<a href="list.html">
				<div>
					<img src="images/icon_cate_selected.png"/>
					<p>分类</p>
				</div>
			</a>
			<a href="shoppingcars.html">
				<div>
					<img src="images/icon_cart.png"/>
					<p>购物车</p>
				</div>
			</a>
			<a href="myself.html">
				<div>
					<img src="images/icon_member.png"/>
					<p>我的</p>
				</div>
			</a>
		</footer>

			<script src="jquery-1.8.2.min.js" type="text/javascript" charset="utf-8"></script>
        <script>
	$(function(){
		//获取url地址上的参数
	   	 var $_GET = (function(){
		    var url = window.document.location.href.toString();
		    var u = url.split("?");
		    if(typeof(u[1]) == "string"){
		        u = u[1].split("&");
		        var get = {};
		        for(var i in u){
		            var j = u[i].split("=");
		            get[j[0]] = j[1];
		        }
		        return get;
		    } else {
		        return {};
		    }
		})();

		//获取初始商品信息
		$(document).ready(function() { 
          var all_category_id=$_GET['category_id']
       
		  // 任何需要执行的js特效 

		  //左侧导航栏
		  $.get("http://"+sever_path+"comm/sel/sel",{"access_token":"84d2acebe4a6","id":all_category_id},function(data){
                
                    if(data.status==0)
                 {
                    var str="<ul><li><a id='all_click' class='category_click' style='color:#F59626;' category_id='0' >全部</a></li>";
                    $.each(data.data,function(k,v){
                     str+="<li><a class='category_click' category_id='"+ v.id+"' >"+v.name+"</a></li>";

                     })
                    str+="</ul>"
                   $(".header").html(str);
                  }else
                  {
                     alert("系统繁忙,请重试")
                  }

                },"jsonp")

		    //展示横幅
		  //展示热销
		  add_show('img_show_new',3);
		  //展示新品
		  add_show('img_show_hot',1);
		  //展示全部
		  add_show('img_show_all',"");
		  function add_show(classname,state){
			  	$.get("http://"+sever_path+"comm/Goodslist/goodslistcategory",{"access_token":"84d2acebe4a6","category_id":all_category_id,"state":state,"limit":"1"},function(data){
	                 if(data.status==0)
	                 {
	                     $.each(data.data,function(k,v){
	                       str='<a href="shoppingInfo.html?goods_id='+v.id+'"><p>'+v.name+'</p><p>'+v.search_words+'</p><img width="100px;" height="65px;" src="'+v.img+'" /></a>' 
	                     })
	                     //alert(str)
	                     $("."+classname).append(str)
	                 }
	                 else
	                 {
	                 	alert("系统加载中，请稍候")
	                 }              
		      },"jsonp")
		  }

		   //点击换拼盘
		  $(document).on("click",".category_click",function(){
		  	  var category_id=$(this).attr("category_id")
               
		  	  if(category_id!=0)
		  	  {
		  	  	$("#all_click").css("color","")
		  	  	$("#goods_new").hide();
		  	  	$("#goods_hot").hide();
                $("#hot_new").hide();
		  	  	 addgoods("","goods_category_all",category_id);
		  	  } 
		  	  else
		  	  {
		  	  	category_id=all_category_id
		  	  	$("#all_click").css("color","#F59626")
		  	  	//新品
			    addgoods(1,"goods_new",category_id);
			    //热销
			    addgoods(3,"goods_hot",category_id);
			    addgoods("","goods_category_all",category_id);
			    $("#goods_new").show();
		  	  	$("#goods_hot").show();
		  	  	$("#hot_new").show();

		  	  }
             //alert(brand_id)
		  	
		  })

          //新品
		  addgoods(1,"goods_new",all_category_id);
		  //热销
		  addgoods(3,"goods_hot",all_category_id);
		  addgoods("","goods_category_all",all_category_id);
          
          		      //向下滑动展示商品
	    $(window).scroll(function() {  
             
	        var scrollTop = $(this).scrollTop(),scrollHeight = $(document).height(),windowHeight = $(this).height();  
	            var positionValue = (scrollTop + windowHeight) - scrollHeight; 
	            console.log(positionValue) 
	         if (positionValue >=(-1)) {  
	         	 now++;
	             addgoods("","goods_brand_all",all_brand_id,now,1);
	          }  
	    });

		  //展示商品方法
		  function addgoods(state,goods_state,category_id,now=0,append=0)
		  {
		  $.get("http://"+sever_path+"comm/Goodslist/goodslistcategory",{"access_token":"84d2acebe4a6","category_id":category_id,"state":state,"limit":"14"},function(data){
                 if(data.status==0)
                 {
                 	 var left_str="";
                 	 var right_str="";
                     $.each(data.data,function(k,v){
                     	if(k%2==0)
                     	{
                     	left_str+='<a href="shoppingInfo.html?goods_id='+v.id+'"><div><img src="'+v.img+'"/><p class="grey">'+v.name+'</p><p class="grey">'+v.search_words+'</p><p class="orange"><img src="images/list (12).png">'+v.market_price+'</p></div></a>' 	
                     	} 
                     	else
                     	{
                     	right_str+='<a href="shoppingInfo.html?goods_id='+v.id+'"><div><img src="'+v.img+'"/><p class="grey">'+v.name+'</p><p class="grey">'+v.search_words+'</p><p class="orange"><img src="images/list (12).png">'+v.market_price+'</p></div></a>' 	
                     	}
                       
                     })
               
                       if(append==1)
                     {
                     	 $("#"+goods_state).find(".left").append(left_str)
                         $("#"+goods_state).find(".right").append(right_str)
                     }
                     else
                     {
                  	document.body.scrollTop = document.documentElement.scrollTop = 0;
                     	 $("#"+goods_state).find(".left").html(left_str)
                         $("#"+goods_state).find(".right").html(right_str)
                     }
                 }
                 else
                 {
                 	alert("系统加载中，请稍候")
                 }              
	      },"jsonp")

		  }
	    })

	 })
</script>
</body>
</html>